<div class="jumbotron" width=15>
  <h4>Saisie de Notes de frais</h4>

  <table>
    <tr>
      <th></th>
    </tr>
    <tr>
      <td>Date de Début : </td>
      <td>{{mission.startDate}}</td>
      <td></td>
      <td>Estimation Prix : </td>
      <td>#</td>
    </tr>
    <tr>
      <td>Date de Fin : </td>
      <td>{{mission.endDate}}</td>
      <td> </td>
      <td>Ville de Départ : </td>
      <td>{{mission.villeDepart}}</td>
    </tr>
    <tr>
      <td>Nature : </td>
      <td>{{mission.nature.code}}</td>
      <td> </td>
      <td>Ville d'arrivée : </td>
      <td>{{mission.villeArrivee}}</td>
    </tr>

  </table>
</div>


<mdb-card class="animated zoomIn">
  <mdb-card-header class="primary-color white-text text-center">

  </mdb-card-header>
  <mdb-card-body>
    <table class="table table-hover table-bordered">
      <thead>
        <tr>
          <th>Date</th>
          <th>Nature</th>
          <th>Montant</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody *ngIf="!modification">
        <tr *ngFor="let ndf of noteDeFraisTab ;let i = index" [attr.data-index]="i">
          <td>{{ndf.date| date : "dd/MM/yyyy"}}</td>
          <td>{{ndf.nature}}</td>
          <td>{{ndf.montant}}</td>
          <td>
            <a><img class="rounded float-center " src="assets/img/ndf-edit.png" alt="edit" width='19px'
                (click)="modifierNdfEntry(ndf.id)"></a>
            <a><img class="rounded float-center ml-4" src="assets/img/ndf-trash.png" alt="delete" width='12px'
                (click)="openModalDelete(templateDelete, ndf.id)"></a>
          </td>
        </tr>
      </tbody>
      <tbody *ngIf="modification">
        <td><input class="form-control mb-1" type="date" name="date" [(ngModel)]="currentNdfEntry.date" required
            #date="ngModel" placeholder="dd/MM/yyyy">
          <div class="invalid-feedback mb-1" *ngIf="(date.dirty || date.touched) && date.invalid">
          </div>
        </td>
        <td>
          <select class="custom-select mb-1" name="nature" id="nature" [(ngModel)]="currentNdfEntry.nature" >
            <option *ngFor="let nature of ndfNature" [ngValue]="nature">{{nature}}</option>

          </select>
        </td>
        <td><input type="text" [(ngModel)]="currentNdfEntry.montant" ></td>



        <td><a class="btn btn-success" (click)="validerModif(templateModif, currentNdfEntryId)" width="4">
            Valider </a>
          <a class="btn btn-warning ml-2" (click)="cancelModif()" width="4"> Annuler </a></td>
      </tbody>
    </table>
    <div *ngIf="!modification" class="text-right">
      <button class="btn btn-success" routerLink="/lignedefrais/creer">+</button>
    </div>
  </mdb-card-body>
</mdb-card>

<ng-template #templateDelete>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Suppression de ligne :</h4>
  </div>
  <div class="modal-body">
    <table class="ml-2">
      <tr>
        <td>Date : </td>
        <td>{{currentNdfEntry.date | date : "dd/MM/yyyy"}}</td>
      </tr>
      <tr>
        <td>Nature :</td>
        <td>{{currentNdfEntry.nature}}</td>
      </tr>
      <tr>
        <td>Montant :</td>
        <td>{{currentNdfEntry.montant}}</td>
      </tr>
    </table>
  </div>
  <div class="modal-footer">
    <p></p>
    <button type="button" class="btn btn-warning" (click)="confirmDelete()">Oui</button>
    <button type="button" class="btn btn-success" (click)="decline()">Non</button>

  </div>

</ng-template>

<ng-template #templateModif>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Ligne modifiée :</h4>
  </div>
  <div class="modal-body">
    <table class="ml-2">
      <tr>
        <td>Date : </td>
        <td>{{currentNdfEntry.date | date : "dd/MM/yyyy"}}</td>
      </tr>
      <tr>
        <td>Nature :</td>
        <td>{{currentNdfEntry.nature}}</td>
      </tr>
      <tr>
        <td>Montant :</td>
        <td>{{currentNdfEntry.montant}}</td>
      </tr>
    </table>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-success" (click)="confirmModif()">OK</button>


  </div>
</ng-template>
