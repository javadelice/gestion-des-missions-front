<div class="row justify-content-center align-items-center mt-4" *ngIf="isAdmin == true; else errorBlock">
  <h1>Nature des Missions</h1>

  <table id="missions" class="table table-striped table-bordered mt-3" cellspacing="0" width="100%">
    <thead class="thead-dark">
      <tr>
        <th class="th-sm">Nature</th>
        <th class="th-sm">Facturée</th>
        <th class="th-sm">Prime</th>
        <th class="th-sm">TJM (€)</th>
        <th class="th-sm">%Prime</th>
        <th class="th-sm">Plafond frais</th>
        <th class="th-sm">Dépt. frais</th>
        <th class="th-sm">Actions</th>
      </tr>
    </thead>

    <tbody *ngFor="let NatureMission of natureMissions">
      <tr>
        <td>{{NatureMission.code}}</td>
        <td>{{NatureMission.isFacturee}}</td>
        <td>{{NatureMission.hasPrime}}</td>
        <td>{{NatureMission.tjm}}</td>
        <td>{{NatureMission.pourcentagePrime}}</td>
        <td>{{NatureMission.plafondFrais}}</td>
        <td>{{NatureMission.depassPlafond}}</td>
        <td><a href=""><img class="mr-3" src="../../assets/img/edition.png" width="20"  alt="edit"></a>
          <a><img src="../../assets/img/delete.png" width="20" alt="delete" (click)="openModal(template, NatureMission.id)"></a></td>
      </tr>
    </tbody>
  </table>
  Ajouter une nature de mission <button type="button" class="btn btn-primary" (click)="openCreateModal(creation)">
      +
    </button>
  </div>

    <ng-template #creation>
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Ajout d'une nature de mission</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
              <p>Nature <input type="text" [validateSuccess]="false" data-error="Un code nature est requis" class="form-control" name="natureCode" mdbInputDirective [(ngModel)]="natMission.code" required></p>
              <p>Facturée
                <select class="custom-select" data-error="Champ obligatoire" name="natureFacturee" id="isFacturee" [(ngModel)]="natMission.isFacturee"
                required #isFacturee="ngModel">
                <option value="OUI">Oui</option>
                <option value="NON">Non</option>
              </select></p>
              <p>Versement prime <input type="text" [validateSuccess]="false" data-error="Veuillez saisir un montant" class="form-control" name="naturePrime" mdbInputDirective [(ngModel)]="natMission.hasPrime" required></p>
              <p>TJM (€) <input type="text" [validateSuccess]="false" data-error="Veuillez saisir un montant" class="form-control" name="natureTJM" mdbInputDirective [(ngModel)]="natMission.tjm" required></p>
              <p>%Prime <input type="text" [validateSuccess]="false" data-error="Veuillez saisir un pourcentage" class="form-control" name="nature%Prime" mdbInputDirective [(ngModel)]="natMission.pourcentagePrime" required></p>
              <p>Plafond frais <input type="text" [validateSuccess]="false" data-error="Veuillez saisir un montant" class="form-control" name="naturePlafond" mdbInputDirective [(ngModel)]="natMission.plafondFrais" required></p>
              <p>Dépt. frais <select class="custom-select" data-error="Champ obligatoire" name="natureDept" id="depassPlafond" [(ngModel)]="natMission.depassPlafond"
                required #depassPlafond="ngModel">
                <option value="OUI">Oui</option>
                <option value="NON">Non</option>
              </select></p>
              <p>Début de validité <input type="text" [validateSuccess]="false" class="form-control" name="natureDebutValidite" mdbInputDirective [(ngModel)]="natMission.debutValidite" required></p>
              <p>Fin de validité <input type="text" [validateSuccess]="false" data-error="Veuillez saisir une date" class="form-control" name="natureFinValidite" mdbInputDirective [(ngModel)]="natMission.finValidite" required></p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
            <button type="button" class="btn btn-primary">Valider</button>
          </div>
        </div>
      </ng-template>

<ng-template #template>
  <div class="modal-body text-center">
    <p>Confirmez-vous la suppression de la mission ?</p>
    <button type="button" class="btn btn-default" (click)="confirm()" >Yes</button>
    <button type="button" class="btn btn-primary" (click)="decline()">No</button>
  </div>
</ng-template>

<ng-template #errorBlock>
    <div class="row justify-content-center align-items-center">
      <p>Vous ne disposez pas des autorisations nécessaires pour accéder à cette page!</p>
    </div>
</ng-template>
